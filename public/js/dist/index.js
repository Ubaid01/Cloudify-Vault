let $2a646fe47127aeb2$var$timer;var $64noG$axios=require("axios");function $parcel$export(e,a,t,d){Object.defineProperty(e,a,{get:t,set:d,enumerable:!0,configurable:!0})}function $parcel$interopDefault(e){return e&&e.__esModule?e.default:e}function $f3eba578751864d4$export$2e2bcd8739ae039(e,a="info",t=3e3){if(!e)return;let d=document.getElementById("flash-alert");d&&d.remove();let o=document.createElement("div");o.className=`alert alert-${a}`,o.id="flash-alert",o.style.setProperty("--duration",`${t/10}ms`);let r=document.createElement("span");r.textContent=e,o.appendChild(r),document.body.appendChild(o),setTimeout(()=>o.classList.add("fade-out"),t-500),setTimeout(()=>o.remove(),t)}$parcel$export(module.exports,"setLastRefresh",()=>$de6cac7a9ed0427b$export$c609ddf809432d5c),$parcel$export(module.exports,"getLastRefresh",()=>$de6cac7a9ed0427b$export$608546384dc1d9e6);let $2a646fe47127aeb2$export$e02251cfbe407ee6=async(e,a)=>{try{let t="login"===a?"/api/users/login":"/api/users/signup",d=await $parcel$interopDefault($64noG$axios)(t,{method:"POST",data:e});"success"===d.data.status&&(a="login"===a?"Logged in":"Signed up",$f3eba578751864d4$export$2e2bcd8739ae039(`${a} successfully! Redirecting...`,"success"),window.setTimeout(()=>{location.assign("/my-uploads")},1500))}catch(e){$f3eba578751864d4$export$2e2bcd8739ae039(e.response.data.message,"error")}},$2a646fe47127aeb2$export$a0973bcfe11b05c9=async()=>{try{let e=await $parcel$interopDefault($64noG$axios).get("/api/users/logout");"success"===e.data.status&&(location.reload(!0),location.href="/")}catch(e){$f3eba578751864d4$export$2e2bcd8739ae039(e.response.data.message,"error")}},$2a646fe47127aeb2$var$REFRESH_INTERVAL=348e4,$2a646fe47127aeb2$var$updateToken=async()=>{try{let e=await $parcel$interopDefault($64noG$axios)("/api/users/refresh-token",{method:"POST",withCredentials:!0});"success"===e.data.status&&($de6cac7a9ed0427b$export$c609ddf809432d5c(Date.now()),$2a646fe47127aeb2$export$f39c3058ef07db36())}catch(e){console.log(e.response.data.message)}};function $2a646fe47127aeb2$export$f39c3058ef07db36(){let e=$de6cac7a9ed0427b$export$608546384dc1d9e6(),a=Math.max(348e4-(Date.now()-e),0);clearTimeout($2a646fe47127aeb2$var$timer),$2a646fe47127aeb2$var$timer=setTimeout($2a646fe47127aeb2$var$updateToken,a)}let $df16eb860252f381$export$69895bd328f2dda9=async e=>{try{let a=await $parcel$interopDefault($64noG$axios)("/api/users/uploads",{method:"POST",data:e});"success"===a.data.status&&($f3eba578751864d4$export$2e2bcd8739ae039("Files uploaded successfully!","success"),window.setTimeout(()=>location.reload(),750))}catch(e){$f3eba578751864d4$export$2e2bcd8739ae039(e.response.data.message,"error")}},$df16eb860252f381$export$dccb98b97a3cb8be=async e=>{try{let a=await $parcel$interopDefault($64noG$axios).delete(`/api/users/delete-file?deleteToken=${e}`);204===a.status&&$f3eba578751864d4$export$2e2bcd8739ae039("File deleted successfully!")}catch(e){$f3eba578751864d4$export$2e2bcd8739ae039(e.response.data.message,"error")}},$de6cac7a9ed0427b$var$signupForm=document.querySelector(".signup-form"),$de6cac7a9ed0427b$var$loginForm=document.querySelector(".login-form"),$de6cac7a9ed0427b$var$logoutBtn=document.getElementById("logout"),$de6cac7a9ed0427b$var$uploadForm=document.querySelector(".upload-form"),$de6cac7a9ed0427b$var$loader=document.querySelector(".div-loader"),$de6cac7a9ed0427b$var$uploadsGrid=document.querySelector(".uploads-grid"),$de6cac7a9ed0427b$var$hasUser=document.body.dataset.user;function $de6cac7a9ed0427b$export$c609ddf809432d5c(e){localStorage.setItem("lastTokenRefresh",e)}function $de6cac7a9ed0427b$export$608546384dc1d9e6(){return parseInt(localStorage.getItem("lastTokenRefresh"))||0}async function $de6cac7a9ed0427b$var$handleUploadForm(){let e=document.getElementById("files"),a=new FormData;for(let t of e.files){if(t.size>5242880)return void $f3eba578751864d4$export$2e2bcd8739ae039("File size should be less than 5MB");a.append("files",t)}await $df16eb860252f381$export$69895bd328f2dda9(a)}$de6cac7a9ed0427b$var$hasUser?($de6cac7a9ed0427b$export$608546384dc1d9e6()||$de6cac7a9ed0427b$export$c609ddf809432d5c(Date.now()),$2a646fe47127aeb2$export$f39c3058ef07db36()):localStorage.removeItem("lastTokenRefresh"),$de6cac7a9ed0427b$var$signupForm&&$de6cac7a9ed0427b$var$signupForm.addEventListener("submit",async e=>{e.preventDefault();let a=new FormData,t=document.getElementById("email").value;if(/[A-Z]/.test(t))return void $f3eba578751864d4$export$2e2bcd8739ae039("Email should be in lowercase");a.append("name",document.getElementById("name").value),a.append("email",t),a.append("password",document.getElementById("password").value),a.append("passwordConfirm",document.getElementById("passwordConfirm").value),a.append("photo",document.getElementById("photo").files[0]),await $2a646fe47127aeb2$export$e02251cfbe407ee6(a,"signup")}),$de6cac7a9ed0427b$var$loginForm&&$de6cac7a9ed0427b$var$loginForm.addEventListener("submit",async e=>{e.preventDefault();let a=document.getElementById("email").value,t=document.getElementById("password").value;document.getElementsByName("remember")[0].checked,await $2a646fe47127aeb2$export$e02251cfbe407ee6({email:a,password:t},"login")}),$de6cac7a9ed0427b$var$logoutBtn&&$de6cac7a9ed0427b$var$logoutBtn.addEventListener("click",$2a646fe47127aeb2$export$a0973bcfe11b05c9),$de6cac7a9ed0427b$var$uploadForm&&$de6cac7a9ed0427b$var$uploadForm.addEventListener("submit",async e=>{e.preventDefault(),$de6cac7a9ed0427b$var$loader.style.display="block",await $de6cac7a9ed0427b$var$handleUploadForm(),$de6cac7a9ed0427b$var$loader.style.display="none"}),$de6cac7a9ed0427b$var$uploadsGrid&&$de6cac7a9ed0427b$var$uploadsGrid.addEventListener("click",async e=>{let a=e.target.closest(".btn-danger");if(a){$de6cac7a9ed0427b$var$loader.style.display="block";let e=a.dataset.id;await $df16eb860252f381$export$dccb98b97a3cb8be(e),$de6cac7a9ed0427b$var$loader.style.display="none";let t=a.closest(".upload-card");t.style.transition="opacity 0.3s",t.style.opacity="0",setTimeout(()=>t.remove(),300)}});
//# sourceMappingURL=index.js.map
